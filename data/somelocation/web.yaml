---
cfweb::global::sites:
    nodedemo:
        server_name: nodedemo.example.com
        apps:
            futoin:
                memory_max: 128
        deploy:
            type: vcsref
            tool: git
            url: 'https://github.com/madhums/node-express-mongoose-demo.git'
            match: 'master'
            deploy_set:
                - >
                    action prepare
                    'ln -s ../.env ./.env'
                    '@default'
                - 'entrypoint web nginx public socketType=unix'
                - 'entrypoint app node server.js internal=1'
                - 'webcfg webroot public'
                - 'webcfg main app'
                - 'webmount / ''{"static":true}'''
        dotenv:
            FACEBOOK_CLIENTID: test
            FACEBOOK_SECRET: secret
            TWITTER_CLIENTID: test
            TWITTER_SECRET: secret
            GITHUB_CLIENTID: test
            GITHUB_SECRET: secret
            LINKEDIN_CLIENTID: test
            LINKEDIN_SECRET: secret
            GOOGLE_CLIENTID: test
            GOOGLE_SECRET: secret

    phpdemo:
        server_name: phpdemo.example.com
        apps:
            futoin:
                memory_max: 64
        deploy:
            type: vcstag
            tool: git
            url: 'https://github.com/symfony/symfony-demo.git'
            deploy_set:
                - 'tools composer php=7.1 yarn'
                - 'env phpExtRequire "curl sqlite3 xml xmlrpc"'
                - 'entrypoint web nginx public socketType=unix'
                - 'entrypoint app phpfpm public/index.php connMemory=16M internal=1'
                - 'webcfg webroot public'
                - 'webcfg main app'
                - 'webmount / ''{"static":true}'''
                - 'persistent var'
                
    pythondemo:
        server_name: pythondemo.example.com
        apps:
            futoin:
                memory_max: 128
        deploy:
            type: vcsref
            match: master
            tool: git
            url: https://github.com/gothinkster/django-realworld-example-app.git
            deploy_set:
                - 'entrypoint app uwsgi conduit/wsgi.py socketType=unix'
                - 'webcfg main app'
                - 'tooltune uwsgi connMemory=64M'
                - >
                    action prepare
                    'sed -i -e "s/ALLOWED_HOSTS\s*=\s*\[\]/ALLOWED_HOSTS=\[\"pythondemo.example.com\"\]/"  -e "s,db.sqlite3,../../persistent/db.sqlite3," conduit/settings.py'
                    '@default'
            
    redmine:
        type: 'cfwebapp::redmine'
        server_name: redmine.example.com
        app_dbaccess:
            cluster: mysrv2
            role: redmine
        memory_max: 256

    
    
cfweb::global::certs: {}
cfweb::global::ruby: true
cfweb::global::php: true
    
